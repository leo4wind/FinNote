<!doctype html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FinNote · 轻记账</title>
    <style>
        :root {
            font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
            color: #1f2933;
            background: #f5f6fb;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 24px;
            background: linear-gradient(135deg, #eef2ff, #f8fbff);
        }

        .app {
            max-width: 960px;
            margin: 0 auto;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 25px 60px rgba(15, 23, 42, 0.15);
            padding: 32px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 32px;
        }

        header h1 {
            font-size: 28px;
            margin: 0;
        }

        header span {
            color: #64748b;
            font-size: 14px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 24px;
        }

        .panel {
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 20px;
            background: #fff;
        }

        .panel h2 {
            margin: 0 0 16px;
            font-size: 18px;
            color: #0f172a;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        label {
            font-size: 14px;
            color: #475569;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d4dae4;
            border-radius: 10px;
            font-size: 15px;
            background: #f8fafc;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        button[type="submit"] {
            border: none;
            background: #2563eb;
            color: #fff;
            padding: 12px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        button[type="submit"]:hover {
            background: #1d4ed8;
        }

        .summary {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .summary-card {
            flex: 1;
            min-width: 160px;
            border-radius: 14px;
            padding: 16px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }

        .summary-card span {
            color: #94a3b8;
            font-size: 13px;
        }

        .summary-card strong {
            display: block;
            margin-top: 6px;
            font-size: 22px;
            color: #0f172a;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .entry-list {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 420px;
            overflow-y: auto;
        }

        .entry-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            background: #fff;
        }

        .entry-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .entry-info strong {
            font-size: 16px;
        }

        .entry-meta {
            font-size: 13px;
            color: #94a3b8;
        }

        .entry-amount {
            font-size: 20px;
            font-weight: 600;
        }

        .entry-amount.expense {
            color: #ef4444;
        }

        .entry-amount.income {
            color: #22c55e;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            padding: 4px 10px;
            border-radius: 999px;
            background: #e0e7ff;
            color: #3730a3;
        }

        .delete-btn {
            background: transparent;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            padding: 4px;
            border-radius: 6px;
        }

        .delete-btn:hover {
            color: #ef4444;
            background: #fee2e2;
        }

        .empty-state {
            text-align: center;
            color: #94a3b8;
            padding: 40px 0;
        }

        @media (max-width: 640px) {
            body {
                padding: 16px;
            }

            .app {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header>
            <h1>FinNote 记账本</h1>
            <span>简单记录 · 本地保存 · 随时回顾</span>
        </header>

        <div class="grid">
            <section class="panel">
                <h2>记一笔</h2>
                <form id="entry-form">
                    <div>
                        <label for="entry-date">日期</label>
                        <input id="entry-date" type="date" required />
                    </div>
                    <div>
                        <label for="entry-type">类型</label>
                        <select id="entry-type" required>
                            <option value="expense">支出</option>
                            <option value="income">收入</option>
                        </select>
                    </div>
                    <div>
                        <label for="entry-category">分类</label>
                        <input id="entry-category" type="text" placeholder="餐饮 / 交通 / 工资" required />
                    </div>
                    <div>
                        <label for="entry-amount">金额</label>
                        <input id="entry-amount" type="number" min="0" step="0.01" placeholder="0.00" required />
                    </div>
                    <div>
                        <label for="entry-notes">备注</label>
                        <textarea id="entry-notes" placeholder="可选"></textarea>
                    </div>
                    <button type="submit">保存</button>
                </form>
            </section>

            <section class="panel">
                <h2>收支概览</h2>
                <div class="summary">
                    <div class="summary-card">
                        <span>收入</span>
                        <strong id="income-total">¥0.00</strong>
                    </div>
                    <div class="summary-card">
                        <span>支出</span>
                        <strong id="expense-total">¥0.00</strong>
                    </div>
                    <div class="summary-card">
                        <span>结余</span>
                        <strong id="balance-total">¥0.00</strong>
                    </div>
                </div>
            </section>
        </div>

        <section class="panel" style="margin-top: 24px;">
            <div class="list-header">
                <h2>收支明细</h2>
                <span class="chip" id="entry-counter">共 0 笔记录</span>
            </div>
            <div class="empty-state" id="empty-state">暂无记录，先记下一笔吧。</div>
            <ul class="entry-list" id="entry-list"></ul>
        </section>
    </div>

    <script>
        const STORAGE_KEY = "finNoteEntries";
        const form = document.getElementById("entry-form");
        const dateInput = document.getElementById("entry-date");
        const typeInput = document.getElementById("entry-type");
        const categoryInput = document.getElementById("entry-category");
        const amountInput = document.getElementById("entry-amount");
        const notesInput = document.getElementById("entry-notes");
        const entryList = document.getElementById("entry-list");
        const emptyState = document.getElementById("empty-state");
        const entryCounter = document.getElementById("entry-counter");
        const incomeTotal = document.getElementById("income-total");
        const expenseTotal = document.getElementById("expense-total");
        const balanceTotal = document.getElementById("balance-total");

        let entries = loadEntries();
        setDefaultDate();
        render();

        form.addEventListener("submit", (event) => {
            event.preventDefault();
            const amount = Number(amountInput.value);
            if (Number.isNaN(amount) || amount <= 0) {
                alert("金额需要大于 0");
                return;
            }

            const entry = {
                id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()),
                date: dateInput.value || new Date().toISOString().split("T")[0],
                type: typeInput.value,
                category: categoryInput.value.trim(),
                amount,
                notes: notesInput.value.trim(),
                createdAt: new Date().toISOString(),
            };

            entries = [entry, ...entries];
            saveEntries();
            render();
            form.reset();
            setDefaultDate();
        });

        entryList.addEventListener("click", (event) => {
            if (!event.target.closest(".delete-btn")) {
                return;
            }
            const { entryId } = event.target.closest(".delete-btn").dataset;
            entries = entries.filter((item) => item.id !== entryId);
            saveEntries();
            render();
        });

        function loadEntries() {
            try {
                const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
                return Array.isArray(saved) ? saved : [];
            } catch (error) {
                console.warn("无法读取本地记录", error);
                return [];
            }
        }

        function saveEntries() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
        }

        function render() {
            renderSummary();
            renderList();
        }

        function renderSummary() {
            const income = entries
                .filter((item) => item.type === "income")
                .reduce((sum, item) => sum + item.amount, 0);
            const expense = entries
                .filter((item) => item.type === "expense")
                .reduce((sum, item) => sum + item.amount, 0);
            const balance = income - expense;

            incomeTotal.textContent = formatCurrency(income);
            expenseTotal.textContent = formatCurrency(expense);
            balanceTotal.textContent = formatCurrency(balance);
        }

        function renderList() {
            entryList.innerHTML = entries
                .map((entry) => {
                    const sign = entry.type === "expense" ? "-" : "+";
                    const amountClass = entry.type === "expense" ? "expense" : "income";
                    return `
                        <li class="entry-item">
                            <div class="entry-info">
                                <strong>${entry.category || "未分类"}</strong>
                                <span class="entry-meta">${entry.date} · ${entry.notes || "无备注"}</span>
                            </div>
                            <div style="text-align: right;">
                                <div class="entry-amount ${amountClass}">${sign}${formatCurrency(entry.amount)}</div>
                                <button class="delete-btn" data-entry-id="${entry.id}" title="删除记录">✕</button>
                            </div>
                        </li>
                    `;
                })
                .join("");

            entryCounter.textContent = `共 ${entries.length} 笔记录`;
            emptyState.style.display = entries.length ? "none" : "block";
            entryList.style.display = entries.length ? "flex" : "none";
        }

        function setDefaultDate() {
            dateInput.value = new Date().toISOString().split("T")[0];
        }

        function formatCurrency(value) {
            return `¥${Number(value).toFixed(2)}`;
        }
    </script>
</body>
</html>
